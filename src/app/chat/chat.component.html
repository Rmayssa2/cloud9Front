<app-header></app-header>
<div class="container-fluid">
  <div class="row" style="padding-top: 8%">
    <div class="col-md-2">


     <!-- <div class="list-group" *ngFor="let chat of chatList">
        <button (click)="loadMyChatRoom(chat)" class="list-group-item">
          {{ chat.username }}
        </button>
      </div>  -->

      <div class="list-group" *ngFor="let chat of chatList">
        <button (click)="loadMyChatRoom(chat)" class="list-group-item">
          <div class="user-icon">{{chat.username.charAt(0).toUpperCase()}}</div>
          <div> {{ chat.username }} </div>
        </button>
      </div>



    </div>


    <div class="col-md-9">
      <section class="chat-window-wrapper">
        <div class="chat-area" id="chat-area d-none">
          <div class="chat-header">
            <header
              class="d-flex justify-content-between align-items-center px-1 py-75"
            >
              <div class="d-flex align-items-center">
                <div
                  class="chat-sidebar-toggle d-block d-lg-none mr-1"
                  id="chat-sidebar"
                >
                  <i
                    class="ficon feather ft-align-justify font-large-1 cursor-pointer"
                  ></i>
                </div>
                <div class="avatar chat-profile-toggle m-0 mr-1">
                  <span class="avatar-status-busy"></span>
                </div>
                <div class="user-icon">{{selecteduser.username.charAt(0).toUpperCase()}}</div>
                <h6 class="mb-0">{{ selecteduser.username }}</h6>
              </div>
            </header>
          </div>
          <!-- chat card start -->
          <div class="card chat-wrapper mb-0">
            <div class="card-content">
              <div class="card-body chat-container" id="componentRef">
                <div class="chat-content" #content>
                  <div
                    s
                    id="chatWindow"
                    class="chat"
                    [ngClass]="
                      currentUser.id === message.user.id
                        ? 'chat-right'
                        : 'chat-left'
                    "
                    *ngFor="let message of list"
                  >
                    <div class="chat-avatar">
                      <a [routerLink]="" class="avatar m-0"> </a>
                    </div>
                    <div class="chat-body">
                      <div class="chat-contain">
                        <p
                          class="chat-message"
                          [ngClass]="{
                            right: currentUser.id === message.user.id,
                            left: currentUser.id !== message.user.id
                          }"
                          *ngIf="message.text"
                        >
                          {{ message.text }}
                        </p>
                        <p
                          class="chat-message"
                          [ngClass]="{
                            right: currentUser.id === message.user.id,
                            left: currentUser.id !== message.user.id
                          }"
                          *ngIf="message.file"
                        >
                          <a
                            href="http://localhost:8080/upload/{{
                              message.file
                            }}"
                            target="_blank"
                          >
                            {{ message.file }}
                          </a>
                        </p>
                        <span
                          class="chat-time"
                          [ngClass]="{
                            right: currentUser.id === message.user.id,
                            left: currentUser.id !== message.user.id
                          }"
                          title="{{ message.date | date }}"
                        >
                          {{ message.date | date : "HH:mm" }}
                        </span>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div
              class="card-footer chat-footer px-2 py-1 pb-0"
              *ngIf="this.conversation"
            >
              <form class="d-flex align-items-center">
                <input
                  type="text"
                  class="form-control chat-message-send mx-1"
                  [(ngModel)]="newMessage"
                  name="newmessage"
                  id="iconLeft4"
                  enctype="multipart/form-data"
                  placeholder="Ecrire votre message ici...."
                  #box
                  (keyup.enter)="onEnter(box.value)"
                />


                <div style="width: 400px" class="custom-file">
           <!-- <input
                    type="file"
                    class="custom-file-input"
                    id="importFile"
                    (change)="selectFile($event)"
                    #fileInput
                  /> --> 

                  <label for="importFile" class="file-icon">
                    <i class="fa fa-file"></i>
                  </label>
                  <input type="file"  class="custom-file-input" id="importFile" (change)="selectFile($event)" #fileInput style="display:none;">
                  
                </div>
                 <!-- <button
                  type="submit"
                  class="btn btn-primary glow send d-lg-flex"
                  (click)="sendMessage()"
                >
                  <i class="ficon feather ft-play"></i>
                  <span class="d-none d-lg-block mx-50">Envoyer</span>
                </button> --> 
                
                
                <a class="btn btn-primary glow send d-lg-flex" style="width: 100xp;" (click)="sendMessage()">
                  <i class="fa fa-paper-plane"></i>
                </a>
              

              </form>
            </div>
            <div
              class="card-footer chat-footer px-2 py-1 pb-0"
              *ngIf="this.conversation == null"
            >
              <button
                type="submit"
                class="btn btn-primary glow send d-lg-flex"
                (click)="startconversation()"
              >
                <i class="ficon feather ft-play"></i>
                <span class="d-none d-lg-block mx-50"
                  >Commencer la conversation</span
                >
              </button>
            </div>
          </div>
          <!-- chat card ends -->
        </div>
      </section>
    </div>
  </div>
  <!-- END: Content-->
  <app-footer></app-footer>
  <!-- app chat profile right sidebar ends -->
</div>
